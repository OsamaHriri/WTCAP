{% extends "base.html" %}
{% load static %}

{% block stylesheets %}

<link rel="stylesheet" type="text/css" href="{% static 'term_labeling/main_tags_style.css'%}">
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
<script src='https://kit.fontawesome.com/a076d05399.js'></script>
<script>
    $(document).ready(function () {
        obj = document.getElementById("1link");
        var clickedItem = $(obj);
        $(".nav-link").each(function () {
            $(this).removeClass("active");
        });
        clickedItem.addClass("active");
        var d = document.getElementsByClassName("navbar")[0];
        d.style.position = "inherit"
    });
</script>
{% endblock stylesheets %}


{% block content %}
<h3 id="poem_id" style="display:none">{{poem_id}}</h3>
<div id="context-menu" class="context-menu">
    <a href="#" onClick="suggestionRightClick(this)">
        <img src="{% static 'term_labeling/img/search.png' %}" alt="Search icon"/> Find in hierarchy
    </a>
    <input type='hidden' value='' id='txt_id'>
</div>

<div id="term-menu" class="term-menu">
    <ul class="term-menu__items">
        <li class="term-menu__item">
            <a href="#" class="term-menu__link" data-action="View" data-toggle="modal"
               data-target="#insertParentModal">
                <i class="fa fa-level-up"></i> Merge a second term
            </a>
        </li>
        <li class="term-menu__item">
            <a href="#" class="term-menu__link" data-action="View" data-toggle="modal"
               data-target="#insertChildModal">
                <i class="fa fa-level-down"></i> Get definition
            </a>
        </li>
        <li class="term-menu__item">
            <a href="#" class="term-menu__link" data-action="Edit" data-toggle="modal" data-target="#editNameModal">
                <i class="fa fa-edit"></i> Get morphology
            </a>
        </li>
    </ul>
</div>

<div class="container text-center" id="main_cont" onload="initialize_index()">
    <br>
    <div class="page-header">
        <h1>{{ poems.name }}</h1>
    </div>
    <br>

    <!-- Modal -->
    <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
         aria-hidden="true">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Current Tags</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <body>
                    <div id="viz" style="height:400px"></div>
                    </body>
                </div>
                <div class="modal-footer justify-content-between">
                    <button type="button" class="btn btn-secondary" onclick="refreshVis()">Refresh</button>
                    <svg height="40" width="70">
                        <circle cx="10" cy="10" r="7" fill="yellow"/>
                        <text text-anchor="start" x="50" y="13"> Word</text>
                        <circle cx="10" cy="30" r="7" fill="#5dade2"/>
                        <text text-anchor="start" x="40" y="33"> Tag</text>
                    </svg>
                </div>
            </div>
        </div>
    </div>

    <div class="row">

        <!-- Tags Section -->
        <div class="col-sm-4 px-lg-5" id="fixed_cont"
             style="position:sticky;top:20px;align-self: flex-start;z-index:1;">
            <!-- Large modal -->
            <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal"
                    onclick="draw()">
                Show
                Current Tags
            </button>
            <!-- Selected Tags Section-->
            <div class="double-border selected_container">
                <h5> Selected Tags </h5>
            </div>

            <!-- Suggested Tags Section-->
            <div class="double-border suggested_container">
                <h5> Suggested Tags </h5>
            </div>

            <!-- Tree Section -->
            <div class="double-border treeview">
                <h5> Tags </h5>

                <input type="text" id="mySearchInput" onclick="$('#tagsDropDown').toggle();" onkeyup="filterSearch()"
                       placeholder="إبحث..." title="إبحث...">
                <div id="tagsDropDown">
                    <ul id="myUL">
                        {% for tag in all_tags %}
                        <li><a href="#" id="{{ tag }}" onclick="searchTag(this)"> {{ tag }} </a></li>
                        {% endfor %}
                    </ul>

                </div>
                <ul class="tree">
                </ul>
                <p> {{'------'}} </p>
                <div>
                    <input type="text" id="newTag" placeholder="addtag.." name="addtag" style="width:150px">
                    <button type="button"><i class="fa fa-check-square" aria-hidden="true"
                                             onclick="submit_clicked()"></i></button>
                </div>
            </div>
        </div>

        <!-- Poem Section -->
        <div class="col-sm-8 paper">
            <table class="table table-hover" id="poem">
                {% for poem in poems.context %}
                <tr>
                    <td>
                        <input type="checkbox" name="{{ forloop.counter }}" value="{{ forloop.counter }}"
                               id="{{ forloop.counter }}" class="tblcheckbox"
                               onchange="box_checked(this, this.value)"/>
                        <label for="{{ forloop.counter }}"> {{ poem.row_index }} </label>
                    </td>
                    <td>
                        {% for term in poem.sadr %}
                        <span class='term' id="{{ forloop.parentloop.counter}}_0_{{ forloop.counter }}"> {{term}} </span>
                        {% endfor %}
                    </td>
                    <td>
                        {% for term in poem.ajuz %}
                        <span class='term' id="{{ forloop.parentloop.counter}}_1_{{ forloop.counter }}"> {{term}} </span>
                        {% endfor %}
                    </td>
                    <td>
                        <button type='button' class='btn btn-light' onclick='save_term_tag()' style="display: none"> Save</button>
                    </td>
                </tr>
                {% endfor %}
            </table>
        </div>

    </div>
</div>

{% endblock content %}

{% block scripts %}
<script src="{% static 'term_labeling/mainpagejs.js' %}"></script>
{% endblock %}

